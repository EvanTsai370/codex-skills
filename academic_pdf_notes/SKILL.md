---
name: Academic PDF Notes Generator
description: Generate comprehensive academic notes from PDF textbooks with structured analysis and external knowledge integration
---

# Academic PDF Notes Generator Skill

## 概述

这个 Skill 帮助从学术 PDF 文档（如教科书）生成高质量的中文学习笔记。它会自动提取 PDF 内容，分析章节结构，并生成包含核心内容总结和深度补充的笔记。

## 何时使用这个 Skill

当你需要：
- 从 PDF 教科书生成学习笔记
- 为多个章节或小节创建结构化笔记
- 保持笔记格式的一致性
- 整合外部知识和现代观点

## 工作流程

### 步骤 1：理解用户需求

用户会提供：
1. **PDF 文件路径**：要处理的 PDF 文档
2. **章节范围**：需要生成笔记的章节（如 14.1-14.6 或 Chapter 5 pages 147-200）
3. **PDF 内容范围**（重要）：明确提取的内容范围
   - **完整章节**：如果用户已提取完整章节内容，会明确说明"这是第X章的全部内容"
   - **页面范围**：如果是页面范围，会说明起止页码
   - **作用**：避免不必要的章节边界查找，直接进入笔记生成
4. **输出位置**：笔记保存的目录（通常是 `300 Main Notes`）
5. **章节结构**（可选）：如果用户提供了章节结构，可以跳过步骤 3 的自动分析
   - 格式示例：
     ```
     - Indexing Basics
     - Indexing Strategies for High Performance
       - Isolating the Column
       - Prefix Indexes and Index Selectivity
       - Multicolumn Indexes
     - An Indexing Case Study
     - Index and Table Maintenance
     ```
   - 如果章节标题是描述性文字（无章节号），强烈建议用户提供结构
6. **特殊要求**：任何额外的格式或内容要求

**⚠️ 重要：批次处理策略**

为了保证笔记质量和避免上下文窗口限制，遵循以下原则：

**推荐的批次大小**：
- ✅ **单章处理**（如第 14 章的所有小节）：最佳选择
- ✅ **2-3 章处理**：可接受，适合相关章节
- ⚠️ **4-5 章处理**：需要注意上下文使用
- ❌ **整本书**：不推荐，应分多次对话处理

**为什么要控制批次大小**：
1. **上下文限制**：AI 的上下文窗口约 200,000 tokens（~150,000 字）
2. **质量保证**：较小批次能保持对细节的关注
3. **错误恢复**：小批次更容易定位和修复问题
4. **用户体验**：避免长时间等待

**如何处理大量章节**：
- 将整本书分成多个对话
- 每个对话处理 1-2 章
- 保持笔记格式一致性（通过 Skill 自动保证）
- 保持笔记格式一致性（通过 Skill 自动保证）

**⚠️ 质量一致性原则（防"虎头蛇尾"）**

我们在处理长章节时容易出现前期笔记详尽、后期笔记草率的情况。这是**不可接受**的。

- **根本原因**：并非上下文限制（通常够用），而是为了"追求效率"或"尽快完成任务"而人为降低了标准。
- **逐个生成**：**必须一次只生成一个章节笔记**，即使后续章节内容较少也不得批量生成
- **强制自检**：在完成最后几个章节的笔记时，必须与第一个章节的笔记进行**深度对比**
- **一致性标准**：如果第一章写了 500 字的深度补充，最后一章只有 100 字，必须重新生成
- **宁缺毋滥**：与其生成草率的笔记以完成任务，不如停止在当前进度，申请新的对话继续生成

### 步骤 2：提取 PDF 内容

使用 `scripts/pdf_extractor.py` 提取 PDF 文本：

```bash
python3 .agent/skills/academic_pdf_notes/scripts/pdf_extractor.py \
  "<PDF文件路径>" \
  --start <起始页码> \
  --end <结束页码> \
  --format text \
  --output extracted_content.txt
```

**关键点**：
- 页码是 1-indexed（从 1 开始）
- 提取完整章节内容，不要遗漏
- 保存提取的内容以便后续分析

### 步骤 3：分析章节结构

**如果用户已提供章节结构**：
- 直接使用用户提供的结构
- 跳过自动分析步骤
- 进入步骤 4 生成笔记

**如果需要自动分析**：

阅读提取的内容，识别：
- 主章节标题（如 14.1, 14.2 或 "Indexing Basics"）
- 子章节标题（如 14.2.1, 14.2.2 或 "Prefix Indexes and Index Selectivity"）
- 重要概念、定理、算法
- 图表引用
- 代码示例

**使用 grep 快速定位**（适用于有章节号的书籍）：
```bash
grep -n "^14\." extracted_content.txt
```

**对于描述性标题的书籍**（如 High Performance MySQL）：
- 查找全大写或首字母大写的标题行
- 识别缩进层级
- 必要时询问用户确认章节结构
- 建议：直接请用户提供章节结构更高效

### 步骤 4：生成笔记

为每个章节创建笔记文件，遵循以下模板结构：

#### 文件命名规范
- 格式：`<中文标题>（<英文标题>）.md`，不要章节号
- 示例：`分布式事务简介（Introduction）.md`

#### 笔记内容结构

参考 `templates/note_template.md`，包含两大部分：

**1. 核心内容总结**
- 忠实原文，全面准确
- 使用结构化分析框架：
  - What（是什么）
  - Why（为什么）
  - How（如何工作）
  - Pros（优点）
  - Cons（缺点）
  - Limitations（局限性）
  - Challenges（挑战）
  - Best Practice（最佳实践）
  - When to use（何时使用）
  - When not to use（何时不使用）
  - 常见误区
- 完整保留代码和公式，公式使用MathJax格式，行内公式使用`$`包裹，行间公式使用`$$`包裹
- 标注图表引用（如"如图14.1所示"）
- 保留对其他章节的引用（如"见§14.5"）

**⚠️ 重要：模板灵活性原则**

> **模板是指导框架，不是强制约束**

上述分析框架（What/Why/How/Pros/Cons 等）是**建议的思考维度**，而非必须全部使用的清单。遵循以下原则：

1. **以原文为准**：
   - 如果原文没有讨论某个维度（如优缺点），不要强行补充
   - 核心总结应忠实反映原文结构，而非套用模板

2. **选择性使用**：
   - 只使用**与内容相关且有实质内容**的维度
   - 例如：纯理论定理可能只需要 What + 证明，不需要 Pros/Cons
   - 例如：算法描述可能需要 What/How/复杂度分析，不需要 When to use

3. **灵活调整**：
   - 可以根据主题特点**增加**新的分析维度
   - 可以**合并**相关维度（如 Limitations 和 Challenges）
   - 可以**删除**不适用的维度

4. **避免无中生有**：
   - 不要为了填充模板而编造内容
   - 如果某个维度原文未提及且你不确定，**宁可省略**
   - 核心总结与深度补充要明确分离

**决策示例**：
- 📖 **定义性章节**（如"什么是事务"）→ 主要使用 What + 特点
- 🔧 **技术实现章节**（如"两阶段提交协议"）→ 使用 What/How/Pros/Cons/Limitations
- 📊 **算法章节**（如"快速排序"）→ 使用 What/How/复杂度分析/示例
- 🧮 **定理证明章节** → 使用 What/证明/推论/应用

**2. 深度补充与拓展**
- 根据概念本身的适用性，补充原文缺少的结构化分析框架中的某个部分
- 引入外部知识和现代技术
- 补充方向包括：
  - 技术原理的深层实现
  - 现代概念与趋势
  - 行业实践与应用案例
  - 横向对比
  - 核心理论/定理
  - 批判性视角
- 使用表格对比不同技术
- 提供实际系统示例

#### 格式要求

- **语言**：中文，术语保留英文（如"事务 (Transaction)"）
- **标题层级**：合理使用 H1-H4
- **代码块**：使用语法高亮
- **引用**：无需引用标记，避免 [cite: x]
- **无须分隔线**：不需要用 `---` 分隔核心总结和深度补充

### 步骤 5：创建索引笔记

如果需要，创建主索引笔记链接所有子章节。

**格式要求 - 极简原则**：
- **只使用简洁的 wiki 链接列表**，不添加任何描述性文字
- **不添加**：章节总结、核心要点、最佳实践、工具箱、快速参考等内容
- **只保留**：章节标题 + wiki 链接列表
- 主索引的作用是**导航**，不是内容总结

**标准示例**（严格遵循此格式）：
```markdown
# 索引与高性能（Indexing for High Performance）

- [[索引基础（Indexing Basics）]]
- [[高性能索引策略（Indexing Strategies for High Performance）]]
- [[索引案例研究（An Indexing Case Study）]]
- [[索引和表维护（Index and Table Maintenance）]]
```

**❌ 错误示例**（过于详细）：
```markdown
# 索引与高性能

## 章节导航

### 1. [[索引基础]]
核心内容：索引的基本概念和类型...
关键要点：B-Tree 索引、哈希索引...

## 核心最佳实践
- 使用覆盖索引...
```

### 步骤 6：验证和完善

- 检查所有笔记文件已创建
- 验证链接正确
- 确保格式一致
- 检查是否有遗漏的图表或代码

**⚠️ 重要：监控上下文使用**

在生成笔记的过程中，需要注意上下文窗口的使用情况：

**上下文监控**：
- 定期检查 token 使用情况（通常会显示在工具输出中）
- 如果上下文使用超过 60-70%，考虑在当前批次结束后停止
- 为后续对话留出足够的上下文空间

**何时停止当前对话**：
- 已生成 3-4 个详细笔记（每个笔记约 15,000-20,000 tokens）
- 上下文使用接近 120,000-140,000 tokens
- 剩余章节内容较多且复杂

**如何继续**：
- 在新对话中继续生成剩余笔记
- 使用明确的 prompt 说明：
  - 已完成的章节
  - 需要继续的章节
  - PDF 文件路径
  - 输出目录
- Skill 会自动保证格式一致性

**示例停止点**：
- 第 5 章：生成 5.1-5.3 后停止，5.4 在新对话中生成
- 第 14 章：如果有 14.1-14.8，可以分为 14.1-14.4 和 14.5-14.8

## 质量标准

### 必须做到

✅ 忠实原文，不遗漏关键信息
✅ 结构清晰，层次分明
✅ 完整保留代码和公式
✅ 标注所有图表引用
✅ 术语中英文对照
✅ 深度补充有价值的外部知识

### 避免

❌ 使用"文档提到"、"本文指出"等字样
❌ 添加引用标记 [cite: x]
❌ 省略代码或公式
❌ 总结未指定的章节
❌ 过于简略，缺乏深度
❌ **生搬硬套模板**，强行使用所有分析维度
❌ **无中生有**，为了填充模板而编造原文没有的内容
❌ **混淆核心总结与深度补充**，在总结中加入外部知识

**负面示例**：
```markdown
<!-- ❌ 错误：原文只是定义性描述，却强行套用所有维度 -->
#### Pros - 优点
- [原文根本没提到优点，这里是编造的内容]

#### When NOT to Use - 何时不使用
- [原文是纯理论定义，不存在"何时不使用"的场景]
```

**正面示例**：
```markdown
<!-- ✅ 正确：只使用适合的维度 -->
#### What - 什么是平面事务
平面事务由一组操作组成...

#### 特点
- 单层结构
- 原子性
<!-- 原文没有讨论优缺点，所以不强行添加 -->
```

## 模板使用决策指南

### 如何判断使用哪些分析维度？

根据章节类型选择合适的分析框架：

#### 📖 概念定义类章节

**特征**：介绍新概念、术语、分类

**推荐维度**：
- ✅ What（定义）
- ✅ 特点/分类
- ✅ 示例
- ⚠️ Why/How（如果原文有）
- ❌ Pros/Cons（通常不适用）

**示例**："14.2 事务分类" → 只需定义 + 特点 + 示例

#### 🔧 技术/协议/机制类章节

**特征**：描述具体的技术实现、协议、机制

**推荐维度**：
- ✅ What（是什么）
- ✅ Why（为什么需要）
- ✅ How（如何工作）
- ✅ Pros/Cons（优缺点）
- ✅ Limitations（局限性）
- ✅ When to use/not use（适用场景）

**示例**："两阶段提交协议" → 完整的分析框架

#### 📊 算法类章节

**特征**：介绍算法、伪代码、复杂度分析

**推荐维度**：
- ✅ What（算法目的）
- ✅ How（算法步骤/伪代码）
- ✅ 复杂度分析（时间/空间）
- ✅ 示例/图解
- ⚠️ Pros/Cons（与其他算法对比时）
- ❌ When to use（除非原文讨论）

**示例**："快速排序算法" → 重点在步骤和复杂度

#### 🧮 定理/证明类章节

**特征**：数学定理、引理、证明

**推荐维度**：
- ✅ What（定理陈述）
- ✅ 证明过程
- ✅ 推论
- ✅ 应用/意义
- ❌ Pros/Cons（不适用）
- ❌ When to use（不适用）

**示例**："主定理" → 陈述 + 证明 + 应用示例

#### 🏗️ 系统设计/架构类章节

**特征**：系统架构、设计模式、组件交互

**推荐维度**：
- ✅ What（架构/设计是什么）
- ✅ Why（设计动机）
- ✅ How（组件交互）
- ✅ Pros/Cons（设计权衡）
- ✅ Challenges（实现挑战）
- ✅ Best Practice（最佳实践）

**示例**："微服务架构" → 全面的分析框架

### 快速决策流程图

```
开始分析章节
    |
    v
原文是否讨论该维度？
    |
    +-- 是 --> 包含该维度
    |
    +-- 否 --> 该维度是否对理解概念至关重要？
                |
                +-- 是 --> 在"深度补充"中添加（标注为外部知识）
                |
                +-- 否 --> 省略该维度
```

### 核心原则总结

1. **忠实原文优先**：核心总结必须反映原文实际内容
2. **质量胜于完整**：宁可少写几个维度，也不要编造内容
3. **明确区分来源**：原文内容 vs. 外部补充要清晰分离
4. **灵活应变**：不同类型章节使用不同的分析框架

---

## 常见场景处理

### 场景 1：处理练习题中的新概念

如果练习题引入了新概念或关键信息：
1. 在核心内容总结中包含这些概念
2. 标注题号（如"练习 14.4-6 引入了..."）
3. 整合到相关章节的讨论中

### 场景 2：处理图表

- 在文中用"如图X.X所示"标记
- 不需要复制图表内容
- 在描述中解释图表的关键信息

### 场景 3：处理代码

- 完整保留所有代码
- 使用适当的语法高亮
- 添加必要的注释说明

### 场景 4：处理跨章节引用

- 保留原文的引用格式（如"见§14.5"）
- 可以添加 Obsidian 链接（如"详见 [[14.5 章节标题]]"）

## 示例

参考 `examples/` 目录中的示例输出，了解期望的笔记质量和格式。

## 技巧和最佳实践

### 提高效率

1. **批量提取**：一次性提取整章内容
2. **使用 grep**：快速定位章节边界
3. **模板复用**：使用一致的笔记结构
4. **并行生成**：可以同时处理多个章节

### 提高质量

1. **深入理解**：先理解内容再总结
2. **结构化思考**：使用 what/why/how 框架
3. **补充现代知识**：联系当前技术趋势
4. **批判性思考**：指出局限性和改进方向

### 常见问题

**Q: 如何确定章节边界？**
A: 使用 `grep -n "^14\." extracted_content.txt` 查找所有章节标题

**Q: 深度补充应该写多少？**
A: 至少与核心总结等量，通常可以更多，提供真正有价值的见解

**Q: 如何处理不熟悉的主题？**
A: 先忠实总结原文，然后搜索相关的现代技术和实践进行补充

**Q: 是否需要总结整本书？**
A: 不需要，严格按照用户指定的章节范围

## 输出检查清单

在完成后，确认：

- [ ] 所有指定章节的笔记都已创建
- [ ] 文件命名符合规范
- [ ] 核心内容总结完整准确
- [ ] 深度补充有实质内容
- [ ] 代码和公式完整保留
- [ ] 图表已标注引用
- [ ] 格式统一一致
- [ ] 链接正确有效
- [ ] 无引用标记 [cite: x]
- [ ] 术语中英文对照

## 工具参考

### PDF 提取工具

位置：`scripts/pdf_extractor.py`

基本用法：
```bash
python3 scripts/pdf_extractor.py <PDF文件> --start <起始页> --end <结束页>
```

详细选项：
- `--format`: 输出格式（text/markdown/json）
- `--output`: 输出文件路径
- `--section`: 查找特定章节
- `--backend`: PDF 引擎（pymupdf/pdfplumber）

### 笔记模板

位置：`templates/note_template.md`

包含完整的笔记结构模板，可以直接复制使用。

## 更新和维护

如果需要调整笔记格式或添加新功能：
1. 更新 `templates/note_template.md`
2. 在 `examples/` 中添加新示例
3. 更新此 SKILL.md 文档

## 总结

这个 Skill 提供了一个完整的工作流程，从 PDF 提取到笔记生成，确保：
- **一致性**：所有笔记使用相同的结构和格式
- **质量**：核心总结 + 深度补充的双层内容
- **效率**：自动化提取和结构化流程
- **可复用**：适用于各种学术 PDF 文档

使用这个 Skill，你可以快速、高质量地为任何学术 PDF 生成学习笔记！
